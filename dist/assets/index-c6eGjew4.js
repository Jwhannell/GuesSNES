(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))t(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&t(r)}).observe(document,{childList:!0,subtree:!0});function s(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(i){if(i.ep)return;i.ep=!0;const o=s(i);fetch(i.href,o)}})();const T=new Map;function $(){return typeof window<"u"&&window.localStorage?window.localStorage:{getItem:e=>T.get(e)??null,setItem:(e,n)=>{T.set(e,n)}}}function z(e,n){const s=$();try{const t=s.getItem(e);return t?JSON.parse(t):n}catch{return n}}function x(e,n){$().setItem(e,JSON.stringify(n))}function w(e){const n=z(e,[]);return new Set(n)}function E(e,n){x(e,Array.from(n))}function k(e,n,s){const t=w(e);if(n.forEach(i=>t.add(i)),t.size>s){const i=Array.from(t).slice(t.size-s),o=new Set(i);return E(e,o),o}return E(e,t),t}function _(e){x(e,[])}const D={i:1,v:5,x:10,l:50,c:100,d:500,m:1e3};function A(e){const n=e.toLowerCase();if(!/^[ivxlcdm]+$/.test(n))return null;let s=0,t=0;for(let i=n.length-1;i>=0;i--){const o=n[i],r=D[o];if(!r)return null;r<t?s-=r:(s+=r,t=r)}return s>0?s:null}function F(e){if(!Number.isFinite(e)||e<=0)return"";const n=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]];let s="",t=Math.floor(e);for(const[i,o]of n)for(;t>=i;)s+=o,t-=i;return s}const B=new Set(["the","of","a","an","to","and","for","in","on","at","vs","vs.","with"]);function p(e,n={}){const{dropStopwords:s=!1}=n;return e.toLowerCase().replace(/[^a-z0-9]+/g," ").split(/\s+/).filter(Boolean).map(t=>{if(/^\d+$/.test(t))return t;const i=A(t);return i!==null?i.toString():t}).filter(t=>s?!B.has(t):!0)}function g(e){return p(e,{dropStopwords:!1}).join("")}function K(e,n){const s=e.length,t=n.length;if(s===0&&t===0)return 1;if(s===0||t===0)return 0;const i=[];for(let r=0;r<=s;r++){const a=[];i.push(a);for(let c=0;c<=t;c++)a.push(0)}for(let r=0;r<=s;r++)i[r][0]=r;for(let r=0;r<=t;r++)i[0][r]=r;for(let r=1;r<=s;r++)for(let a=1;a<=t;a++){const c=e[r-1]===n[a-1]?0:1,l=i[r-1][a]+1,u=i[r][a-1]+1,d=i[r-1][a-1]+c;i[r][a]=Math.min(l,u,d)}return 1-i[s][t]/Math.max(s,t)}function W(e,n){const s=g(e),t=g(n);if(s===t)return!0;const i=p(e,{dropStopwords:!0}),o=p(n,{dropStopwords:!0});if(i.length===0||o.length===0)return!1;const r=new Set(i),a=new Set(o);let c=0;for(const H of r)a.has(H)&&c++;const l=c/r.size,u=c/a.size,d=c,h=a.size===1,m=h?1:2,G=o[o.length-1],P=h||(G?r.has(G):!1),R=l>=.6&&u>=.5;return!!(P&&d>=m&&R||s.length>=5&&K(s,t)>=.8&&s.length>=t.length*.5)}function j(e,n){const s=n.split(/\s+/).filter(Boolean);let t=e;for(const i of s){const o=i.replace(/[^a-zA-Z0-9]/g,""),r=/^\d+$/.test(o),a=A(o),c=a!==null;if(o.length<2&&!r&&!c)continue;const l=[];if(l.push(o),r||(l.push(o+"s"),l.push(o+"es"),l.push(o+"'s"),l.push(o+"s'")),c&&l.push(a.toString()),r){const u=F(Number(o));u&&l.push(u)}for(const u of l){const d=u.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),h=new RegExp("\\b"+d+"\\b","gi");t=t.replace(h,m=>"_".repeat(m.length))}}return t}function S(e,n=Math.random){return e.map((s,t)=>({item:s,sortKey:n(),idx:t})).sort((s,t)=>s.sortKey-t.sortKey).map(s=>s.item)}function X(e){const n=new Set,s=[];for(const t of e)n.has(t)||(n.add(t),s.push(t));return s}function L(e){return g(e).slice(0,120)}function V(e){const n=e.split(new RegExp(`(?<=[.!?])\\s+(?=[A-Z0-9"'])`)).map(s=>s.trim()).filter(Boolean);return n.length===0?[e.trim()].filter(Boolean):n}function O(e,n){const{minLen:s=30,maxLen:t=180,maxHints:i=6,rng:o=Math.random}=n||{},a=V(e).filter(u=>u.length>=s&&u.length<=t),c=X(a);return S(c,o).slice(0,i)}function Y(e,n){return e.filter(s=>!n.has(L(s)))}const y="sgl_used_hint_hashes_v1",b="sgl_seen_game_ids_v1",q=500,U=200,v=6,M=[{id:"1",title:"Super Mario World",reviewSnippets:[]},{id:"2",title:"The Legend of Zelda: A Link to the Past",reviewSnippets:[]},{id:"3",title:"Chrono Trigger",reviewSnippets:[]},{id:"4",title:"Final Fantasy VI",reviewSnippets:[]},{id:"5",title:"Super Metroid",reviewSnippets:[]},{id:"6",title:"Donkey Kong Country",reviewSnippets:[]},{id:"7",title:"Street Fighter II Turbo",reviewSnippets:[]},{id:"8",title:"Super Mario Kart",reviewSnippets:[]},{id:"9",title:"Mega Man X",reviewSnippets:[]},{id:"10",title:"Earthbound",reviewSnippets:[]}];function J(){return w(b)}function Z(e){return k(b,[e],U)}function N(){_(b)}function I(e){const n=J(),s=e.filter(o=>!n.has(o.id)),t=s.length>0?s:e,i=t[Math.floor(Math.random()*t.length)];if(!i)throw new Error("No games available");return s.length===0&&N(),Z(i.id),i}const Q="https://en.wikipedia.org/w/api.php";async function ee(e,n=fetch){const s=new URLSearchParams({action:"query",prop:"extracts",exsentences:"40",format:"json",origin:"*",titles:e});s.append("explaintext","1");try{const t=await n(`${Q}?${s.toString()}`);if(!t.ok)throw new Error(`Wiki fetch failed: ${t.status}`);const o=(await t.json())?.query?.pages??{},r=Object.keys(o)[0];if(!r)return null;const a=o[r]?.extract;return a||null}catch(t){return console.warn("Failed to fetch wiki extract",t),null}}function te(){return w(y)}function ne(e){const n=e.map(L);return k(y,n,q)}function se(){_(y)}function ie(e){const n=[`${e.title} was critically acclaimed on the SNES.`,`Players praised ${e.title} for its gameplay and visuals.`,`${e.title} introduced memorable mechanics for its genre.`,`${e.title} has a soundtrack fans still adore.`,`${e.title} features iconic bosses and levels.`,`${e.title} remains a fan favorite decades later.`].join(" ");return O(n,{maxHints:v})}async function re(e,n){const{fetchImpl:s=fetch,rng:t=Math.random}={},i=te(),o=await ee(e.title,s),r=o?O(o,{maxHints:v*5,rng:t}):ie(e),a=Y(r,i);if(a.length===0)throw new Error("No new hints available for this game");const l=S(a,t).slice(0,v);return ne(l),l}async function oe(){try{return M}catch(e){return console.warn("Failed to fetch games, using mock data:",e),M}}class ae{constructor(n,s){const{rng:t=Math.random}=s||{},i=n.reviewSnippets??[],o=S(i,t);this.state={targetGame:n,guesses:[],maxGuesses:6,gameStatus:"playing",hintsRevealed:1,shuffledHints:o}}getState(){return{...this.state,shuffledHints:[...this.state.shuffledHints]}}makeGuess(n){return this.state.gameStatus!=="playing"?!1:(this.state.guesses.push(n),W(n,this.state.targetGame.title)?(this.state.gameStatus="won",!0):(this.state.hintsRevealed=this.state.guesses.length+1,this.state.guesses.length>=this.state.maxGuesses&&(this.state.gameStatus="lost"),!1))}getHints(){const n=[],s=this.state.shuffledHints;for(let t=0;t<this.state.hintsRevealed&&t<s.length;t++){const i=s[t];if(i){const o=j(i,this.state.targetGame.title);n.push(o)}}return n}getRemainingGuesses(){return this.state.maxGuesses-this.state.guesses.length}getGuesses(){return[...this.state.guesses]}isGameOver(){return this.state.gameStatus!=="playing"}hasWon(){return this.state.gameStatus==="won"}getAnswer(){return this.state.targetGame.title}}let f=null;function ce(e="Loading a new game..."){const n=document.getElementById("app");n&&(n.innerHTML=`<div class="loading"><p>${e}</p></div>`)}async function le(){const e=document.getElementById("app");if(e){ce();try{const n=await oe();let s=I(n),t=[];const i=Math.min(n.length,5);for(let o=0;o<i;o++)try{if(t=await re(s),t.length>0)break}catch{s=I(n)}if(!t||t.length===0)throw new Error("Could not fetch fresh hints for any game");s.reviewSnippets=t,f=new ae(s),C()}catch(n){e.innerHTML='<div class="loading"><p>Failed to load game. Please refresh.</p></div>',console.error("Game initialization failed:",n)}}}function C(){const e=document.getElementById("app");if(!e||!f)return;f.getState();const n=f.getHints(),s=f.getGuesses(),t=f.getRemainingGuesses(),i=f.isGameOver(),o=f.hasWon();let r=`
    <div class="game-info">
      <div class="info-item">
        <div class="info-label">Guesses Left</div>
        <div class="info-value">${t}</div>
      </div>
      <div class="info-item">
        <div class="info-label">Hints Revealed</div>
        <div class="info-value">${n.length}</div>
      </div>
    </div>
  `;if(r+='<div class="hints-section">',r+='<div class="hints-title">üìù Hints:</div>',n.length===0?r+='<div class="no-hints">No hints available yet.</div>':n.forEach((a,c)=>{r+=`<div class="hint">${c+1}. ${a}</div>`}),r+="</div>",s.length>0&&(r+='<div class="guesses-section">',r+='<div class="hints-title">‚ùå Previous Guesses:</div>',s.forEach((a,c)=>{r+=`
        <div class="guess-item">
          <span class="guess-number">#${c+1}</span>
          <span>${a}</span>
        </div>
      `}),r+="</div>"),i){const a=o?"won":"lost",c=o?"üéâ You Won!":"üò¢ Game Over",l=o?`You guessed it in ${s.length} ${s.length===1?"try":"tries"}!`:"Better luck next time!";r+=`
      <div class="game-over ${a}">
        <div class="game-over-title">${c}</div>
        <div>${l}</div>
        <div class="answer">The answer was: <strong>${f.getAnswer()}</strong></div>
        <button class="new-game-btn" onclick="window.location.reload()">üîÑ Play Again</button>
      </div>
    `}else r+=`
      <div class="input-section">
        <form id="guess-form" class="input-group">
          <input 
            type="text" 
            id="guess-input" 
            placeholder="Enter your guess..."
            autocomplete="off"
            required
          />
          <button type="submit">Guess</button>
        </form>
      </div>
    `;if(e.innerHTML=r,!i){const a=document.getElementById("guess-form"),c=document.getElementById("guess-input");a&&c&&(a.addEventListener("submit",l=>{l.preventDefault();const u=c.value.trim();u&&f&&(f.makeGuess(u),C(),f.isGameOver()||(c.value="",c.focus()))}),c.focus())}}globalThis.resetHintHistory=()=>{try{N(),se(),console.info("Hint/game history cleared.")}catch(e){console.warn("Failed to reset history",e)}};le();
